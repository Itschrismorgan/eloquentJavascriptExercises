<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title>Exercise 17.1 - Content Negotiation</title>
</head>
<body>
    <p>
        Must be run in the sandbox because of CORS lacking -- http://eloquentjavascript.net/code/#17.1
    </p>

    <script>
        function getURL(url, callback,contentType) {
            var req = new XMLHttpRequest();
            req.open("GET", url, true);
            req.setRequestHeader('accept',contentType);
            req.addEventListener("load", function() {
                if (req.status < 400)
                    callback(req.responseText);
                else
                    callback(null, new Error("Request failed: " +
                    req.statusText));
            });
            req.addEventListener("error", function() {
                callback(null, new Error("Network error"));
            });
            req.send(null);
        }

        getURL('http://eloquentjavascript.net/author',function(data){console.log(data);},'text/plain');
        getURL('http://eloquentjavascript.net/author',function(data){console.log(data);},'text/html');
        getURL('http://eloquentjavascript.net/author',function(data){console.log(data);},'application/json');
        getURL('http://eloquentjavascript.net/author',function(data){console.log(data);},'application/rainbows+unicorns');

    </script>
</body>
</html>